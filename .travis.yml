services:
- docker
script:
- docker build --target travistest --tag todo-app:travis .
- docker run todo-app:travis tests
- docker run --env TRELLO_KEY --env TRELLO_TOKEN --env SECRET_KEY todo-app:travis tests_e2e
deploy:
  provider: script
  script: bash todo_app/deploy.sh
  on:
    branch: master
env:
  global:
  - secure: ueCzDPFfr9WyT6SsGY4bH/7D6rdNOadN3dTgmDPoFkWXv4mKkCwEWAKXS0Cm17vzlRBHRrnxoX/ty+ZKPiRgD8ljPgm2ZhbikMwV8Y0zdV/x3wD7F5eVnQo9ofVez1AG0cgeXHdz9knkZnapl/Q6zN6mLrLOmjK2M4SSI5oBNnoBnToDIVLQ+/xUu8vJu9+bLBZtcuFFFlIVLkowjfIt+ztuAYc05QryqybKHirDfeLF8JeYynApRV1T97NJC977f0xw7DQFq226HqDBYXb7GGs1CTHJtNLLkW3gRxAbW5Nx5NX55cdnQ+0sfS9UjHj6qDFhlt6MkLr6Ijpnh28bGiz0TJwUSJ4CubCXfXqZ4vm43qaXT4yd8P9I7KDEEJEoeHSCdQaAyN/6LjwmV0kICMotHK/sg8VAPlaRQcy5wAZ5KvRgBuF5PiV/BpXZgy+oSNwNCo2DUjQ8APBGaxIZAqw5Aea6U0vBLa+4QAM2Dk7o+WgdEv/1OCe8gqgruGFWU66zp2dyRnow6xKEY6aq2No3Y8xjftAcaQTZdb806ajwkPPUzaPTV+/80ACgXkmlubISP/68PDaIyAY0DBXEBY07WsvIsRxK0QUCtjCqxeL+B2Ib8rSriSVweXovqvLTzNv1vVLU9tW+AZdZc0tZ4Kyx5d04tRM7QEAtPJ0JGZE=
  - secure: mqh+5fo2CUlPnqqH/txfmySwR5dauIiYNdCSTL9Qdvh34N9HodqPP0R+lv7wBPbe9g1n22hkX2st3UiGHwtAFdV3v585vrI+RqeJKfgSDZOL9eCshZBXVfQQ3cniWhpxm+EyO/hSZh/3dQ7BXMwimFkOE7DWEhyrmXQIpEuO2gmE+zOLj8mkWkWrvOkgSXkQ7KRhziZwvYzsZIWxpjY1X2tmIcyUX25MqCsplUQzvo1pXUwg70Qb6J2R9qyCKU0312ooA+PqLoWpivzc/R7vdugS17eCI7e3AQhZFLqZKUBDtiEjvhDU3UmZbtFTUpHoKpCrLbtzQZ/fZMw37h7dPs/l+O+zeASKMh4XVi4qi6GAszW+fdOQzoEFSaTzrEaqHjahIHSkuklPmu3WNoaLa1alOV0aZm+nGPerEfdkKoVDoDk6SOwMAjMfByJdqqeEuy8p67S0O+BU8SpLy5XV5BCUipovk4i97Vd+RsItnkHL5nNbybENWlJOtnwPXf17zMXqvmEgxLL7XwqZFZQBibCRj62CmoNUPgU0LWsh8uaMGBwPF3S44R2EALwoKclG62G0GBmbjW/qZZCTyeppd1Zdh5JigikMepd+DoN0B7IWFPzt0IAkkWaPZZGmNb8rs68cxOTx1bOLlfq7oRQE69L+Jcu4qcoI09/Z8Lkn1cA=
  - secure: MYBks1vaZ//c6e7PptICofK+EOgOoJmak+7XtUS03MKlu47UUwqxfux+fugz1z5QxZQ4VYx4JXFFbrbm353g07pEHfhPdilojXc0ynmwBwjmcuuvA8CI5hkcAD+E1dy9cdpMatWKOf1W5Q1BZJ1d2XTLTHAHPbS70CknIs9Z+zDwatv+JhlDESp6am3GU8K1Nnvspe0I9zyUKqjO0Ka1uHPTNO6K1u9xWYfyVBFNR0sSH6/GLDS34QmgjSJsNd1SnMso3jWyEnoA4m+Bj77QLClxUhOK08pfhr0QWyR657vnYoUBUhpSuw4eoMzFpyaPK2Q6khR3kqoygh2BE63o4ODzkXcO7Et9tlpBz49fgMsUAfTxLIjLYzBvfgj3+nXpAwzJwh5h+bdgS/ysQtaSuELfL3BwRF7Jf0ChoxLL+ik1/ZksW8w0pT6YF/mjk8L7+AMKRK3rYlX1Dw2BVUns/KnJLd4AOaLNpBfiFDY8FVrvuIlVRgHU5AuMGAIppWRoxaondJpiH3xTYGXbOWUgzUTcBm68Vq1LzMGNcTU6Y7u8/IBIJEjSweeM8OhvXLyphcphVpoK4QLIzAxsumV65/jjZ8oyjRh+tBjGVfwx0DB2Mrhp5CMwjE+8huZdIN4QfjDtSsLKZt2kAwE0ctkfZ57Q7/WBihQ97AdbktXBrVE=
  - SECRET_KEY=secret-key
  - FLASK_APP=app
  - FLASK_ENV=development
  - secure: PyhJN6ZNtSH06PfTvwfvNZtvLaJL8j6Y+fXOH+kn+AJG3k6xrf4zpOh7CNpkm2QrrRaT4TU+1Gcym0US6ZJ0khOet5ebWDs1jic8oypKTO7kR60cs9s0ZMDJMKMJ6T6QTMncgQaxfmjlZSYL3tvPsvnT/16JRWfGKXxbNHXXsSPZrdOhUOQeadCZcZGpb6AdR5ZaV0DcHfc4/wie6j0NOT1+MzRDemS7dMNmgi0pXaaOXVd9R8S5Cx3JX6K+JndiquDBG0wWlgqr1PwSoyXjaAQegnlssE37fbBGLctTg6uFgh14KxaS+9ie4g0fr1978akK/FTXEu0Sd7BOm67EUfCJa5CzPRMVSwn34ydhhIyLPyyJMndg+ML22IFZYia57IkkToRQpmSrtqGOnNQF50/7I8PLIeQVd7DMoNfdaSNT0vyR61DnqMyW5unXfosq1k7jI4H/GG1BhjsC5p18fxgtO5SVRHoJKG09WYcI6Kr/Lt4eMo8nlvA1btLn2q7djqcu3pdb2tPzzvaMpok+alKiqGIT6AePm8ZT3vSxjiA4I6U7r+3G9DucmL3jiSfSaNl6VRKRc9p0swTuBl/N8luuRlhjRJPRxd7YV6zUn1RVAFrub3KzPcOfqBrxbSKfEf3FFzMwO7b7UM9qXmA3rZKaPAY2x9iAz/ngvXYP1Ns=
  - secure: bPeA2bTZl7gfpAK1qJJlNnfZa4Gy8RRbbxrMzBa06TzmwR6FwgkMPs2s9r9YECdS26ffrQhqw8WeGuInnv6dHiL8He4erkwIY5cMY5zLHTFvXfvkaG83k2orKOBIEwrWLBK/NWAAd87zCBGEQIv3ouQ8TyCwrvt/rKZ9WSgyGn/RnTbXNon3AVCyz25i6XIZORBUQXtd1A7GhPmPXu0yPb/7fhMUa88juoRf5kFow3EFN/kySaXATaGhye2f3047MIaWzDQUTY4TPaHkqQ7EAFhs7ixmIi9WAVf5+wTHD3ib+voMZNKEqGTPRPLkjuC9lFuHi4QXPL5xi8ZWu64jHOM2XwjSu5u8AkGDT/7xI0T4tW2UV3NoJfxjyfb5GV+fwa3vkghilrGzxFArd+zo+bctiIg/tyVPpgoV5qoQmpE4UDpHY2Iwy3cDXA2oF3WseOr0E+iuYI6h81xPI97RBjD2VcAaNw+Wsbj2uRv1zWQt9gtWIzhHqS9mSEUGZJsv0M8Oiw+byrT/TvWPNcT6Q/DD6q1+em2R5gk/HdyZp/sIq/iYNmyW26+AAacZBUDwM9ttQ1r3sgaA1Q6I4azrTO7Hy3QK1A/udKeL3OlPF0cxUdPGCkMl2sIAucKjTBttwb68sEOqjrDa3ZYWp6KWn0qdIZ3GeKVFj6ITi6mi5gw=
  notifications: 
  slack:
    secure: VY5FnTJoDaCRx46cR2pvQqM5mqBzoR4iVSRblNqt2dYx8HwMGdWJjb5SPTQfToCdY3WWn0bqVFAuXNz+GsOha2XILNZXgqejo0GexRwA+yPkon8cCH/8h/sPWUWu/qeO4/bO00IC5nYkmpKmVlSg+9CcRybopF/RGgRNapTa484uAUlRrTfRWhVwCe7RgNTMf1wGbRmOOeKxoTTKOfW2tpX4xgt2dNC+8Wr9cYbfuH+4yBHghXSB327JRTTH7K5VEOh+SVJRj5L6lQ4SplZrb/1EXUAMgip+iOnjnDQiRum93ChmLEo0OUaLrl1V3RsocjF6FXZBPBNAuWvUbNywcAI/tOAQt5BASRXHJ1HreZRt6q0B5BJAUThS7ESQ3DxDClRgQzkwPwopsCurxhxHnV0EwSMKUXuaRyJc7nhHHuiYBeF5qjJ7p2f19nr7bta/D7YrAU/uEI+vDMx205U85PBsPAvtQZcW0gz65L1GAb0slalSlMftGJTxcUQTN2eoLclWtn0R1neoi/xve96k4E30pxBizUwlkk/dGlM3xVhHAG6NRkrjy2F97fo9bHB/K+lYDNBL/BfHqAvMv131VaKq4xgPGZTuFMqG1cZ2NsLwCIowtUY73FB2CQgrjf4enVL0X3tLTQtDfknHnzP5SPIkW/SagWIB2v1vko4C1MA=
  email:
    recipients:
    - kevin.eaton@capita.com
    on_success: never
    on_failure: always
