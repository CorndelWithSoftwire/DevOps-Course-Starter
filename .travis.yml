services:
- docker
script:
- docker build --target travistest --tag todo-app:travis .
- docker run todo-app:travis tests
- docker run --env TRELLO_KEY --env TRELLO_TOKEN --env SECRET_KEY todo-app:travis
  tests_e2e
after_success:
- echo $DOCKER_PASSWORD | docker login --username $DOCKER_USER --password-stdin
- docker build --target production --tag kevineatondevops/todo-app:latest --tag kevineatondevops/todo-app:$TRAVIS_COMMIT
  .
- docker push kevineatondevops/todo-app:latest
true:
  branch: master
env:
  global:
  - secure: ueCzDPFfr9WyT6SsGY4bH/7D6rdNOadN3dTgmDPoFkWXv4mKkCwEWAKXS0Cm17vzlRBHRrnxoX/ty+ZKPiRgD8ljPgm2ZhbikMwV8Y0zdV/x3wD7F5eVnQo9ofVez1AG0cgeXHdz9knkZnapl/Q6zN6mLrLOmjK2M4SSI5oBNnoBnToDIVLQ+/xUu8vJu9+bLBZtcuFFFlIVLkowjfIt+ztuAYc05QryqybKHirDfeLF8JeYynApRV1T97NJC977f0xw7DQFq226HqDBYXb7GGs1CTHJtNLLkW3gRxAbW5Nx5NX55cdnQ+0sfS9UjHj6qDFhlt6MkLr6Ijpnh28bGiz0TJwUSJ4CubCXfXqZ4vm43qaXT4yd8P9I7KDEEJEoeHSCdQaAyN/6LjwmV0kICMotHK/sg8VAPlaRQcy5wAZ5KvRgBuF5PiV/BpXZgy+oSNwNCo2DUjQ8APBGaxIZAqw5Aea6U0vBLa+4QAM2Dk7o+WgdEv/1OCe8gqgruGFWU66zp2dyRnow6xKEY6aq2No3Y8xjftAcaQTZdb806ajwkPPUzaPTV+/80ACgXkmlubISP/68PDaIyAY0DBXEBY07WsvIsRxK0QUCtjCqxeL+B2Ib8rSriSVweXovqvLTzNv1vVLU9tW+AZdZc0tZ4Kyx5d04tRM7QEAtPJ0JGZE=
  - secure: mqh+5fo2CUlPnqqH/txfmySwR5dauIiYNdCSTL9Qdvh34N9HodqPP0R+lv7wBPbe9g1n22hkX2st3UiGHwtAFdV3v585vrI+RqeJKfgSDZOL9eCshZBXVfQQ3cniWhpxm+EyO/hSZh/3dQ7BXMwimFkOE7DWEhyrmXQIpEuO2gmE+zOLj8mkWkWrvOkgSXkQ7KRhziZwvYzsZIWxpjY1X2tmIcyUX25MqCsplUQzvo1pXUwg70Qb6J2R9qyCKU0312ooA+PqLoWpivzc/R7vdugS17eCI7e3AQhZFLqZKUBDtiEjvhDU3UmZbtFTUpHoKpCrLbtzQZ/fZMw37h7dPs/l+O+zeASKMh4XVi4qi6GAszW+fdOQzoEFSaTzrEaqHjahIHSkuklPmu3WNoaLa1alOV0aZm+nGPerEfdkKoVDoDk6SOwMAjMfByJdqqeEuy8p67S0O+BU8SpLy5XV5BCUipovk4i97Vd+RsItnkHL5nNbybENWlJOtnwPXf17zMXqvmEgxLL7XwqZFZQBibCRj62CmoNUPgU0LWsh8uaMGBwPF3S44R2EALwoKclG62G0GBmbjW/qZZCTyeppd1Zdh5JigikMepd+DoN0B7IWFPzt0IAkkWaPZZGmNb8rs68cxOTx1bOLlfq7oRQE69L+Jcu4qcoI09/Z8Lkn1cA=
  - secure: MYBks1vaZ//c6e7PptICofK+EOgOoJmak+7XtUS03MKlu47UUwqxfux+fugz1z5QxZQ4VYx4JXFFbrbm353g07pEHfhPdilojXc0ynmwBwjmcuuvA8CI5hkcAD+E1dy9cdpMatWKOf1W5Q1BZJ1d2XTLTHAHPbS70CknIs9Z+zDwatv+JhlDESp6am3GU8K1Nnvspe0I9zyUKqjO0Ka1uHPTNO6K1u9xWYfyVBFNR0sSH6/GLDS34QmgjSJsNd1SnMso3jWyEnoA4m+Bj77QLClxUhOK08pfhr0QWyR657vnYoUBUhpSuw4eoMzFpyaPK2Q6khR3kqoygh2BE63o4ODzkXcO7Et9tlpBz49fgMsUAfTxLIjLYzBvfgj3+nXpAwzJwh5h+bdgS/ysQtaSuELfL3BwRF7Jf0ChoxLL+ik1/ZksW8w0pT6YF/mjk8L7+AMKRK3rYlX1Dw2BVUns/KnJLd4AOaLNpBfiFDY8FVrvuIlVRgHU5AuMGAIppWRoxaondJpiH3xTYGXbOWUgzUTcBm68Vq1LzMGNcTU6Y7u8/IBIJEjSweeM8OhvXLyphcphVpoK4QLIzAxsumV65/jjZ8oyjRh+tBjGVfwx0DB2Mrhp5CMwjE+8huZdIN4QfjDtSsLKZt2kAwE0ctkfZ57Q7/WBihQ97AdbktXBrVE=
  - SECRET_KEY=secret-key
  - FLASK_APP=app
  - FLASK_ENV=development
notifications:
  slack:
    secure: VY5FnTJoDaCRx46cR2pvQqM5mqBzoR4iVSRblNqt2dYx8HwMGdWJjb5SPTQfToCdY3WWn0bqVFAuXNz+GsOha2XILNZXgqejo0GexRwA+yPkon8cCH/8h/sPWUWu/qeO4/bO00IC5nYkmpKmVlSg+9CcRybopF/RGgRNapTa484uAUlRrTfRWhVwCe7RgNTMf1wGbRmOOeKxoTTKOfW2tpX4xgt2dNC+8Wr9cYbfuH+4yBHghXSB327JRTTH7K5VEOh+SVJRj5L6lQ4SplZrb/1EXUAMgip+iOnjnDQiRum93ChmLEo0OUaLrl1V3RsocjF6FXZBPBNAuWvUbNywcAI/tOAQt5BASRXHJ1HreZRt6q0B5BJAUThS7ESQ3DxDClRgQzkwPwopsCurxhxHnV0EwSMKUXuaRyJc7nhHHuiYBeF5qjJ7p2f19nr7bta/D7YrAU/uEI+vDMx205U85PBsPAvtQZcW0gz65L1GAb0slalSlMftGJTxcUQTN2eoLclWtn0R1neoi/xve96k4E30pxBizUwlkk/dGlM3xVhHAG6NRkrjy2F97fo9bHB/K+lYDNBL/BfHqAvMv131VaKq4xgPGZTuFMqG1cZ2NsLwCIowtUY73FB2CQgrjf4enVL0X3tLTQtDfknHnzP5SPIkW/SagWIB2v1vko4C1MA=
  email:
    recipients:
    - kevin.eaton@capita.com
    on_success: never
    on_failure: always
dd:
  secure: nnKnsSneKFGhTIDAizQ5VMS45RMm3lpWeLV1QTj+p/VtQafT9sGVigHE4gAW89feb8rwEODtWnJf57E2fY/CQfZ8xL5ztJs4HZR8Iu4SJRUWW0IE8qJXx3ZSm0vmvAYTpsNyXSHdCLPAk8mOFQ5QxgaOBKxpklQNwHXFwnmUPJMRN39hVfyU3kCZWGu4GW8BDBFaxxAJMoESsIhxmwQbgWHQdERm+rSpzSnV7q9mQ8LbTkvWYpRHfLX0uDexAigDc/NY2huTfcR1qNo697F+j5mydQR6g1EFC+VcCW6Q/5rN0z3iueksFt7pz3JHFdzKH+wIjYyHmnGhcecNp28zPcm+2E/pV7tnQWr2iNsPwmoukq5EUn/XWcObtOtJdx/cdx/4z6KMynlTELHQ6d9+gQ5TkQMZmxPmTFVhZxEsEDvX5CQ6CRfckjW8DgNv8B/kHB1C2QyI442hu4u55V4fyozc1JxfmgjG5mIIFGPocEHsTFqsTrsRUl6Pu/GYhs8EknIVr4yVnfc2bjz9JbbuU0lliuL+DDwvU6AaTw/lCWC/2yu/TAs8G/whjWozHSb7eeYZwVqMzUgZWPrhHmlyTbqT2fXXUUnFh2SFsGp6KhJnz7vHzHlFp3HCGB5TJmVrc7fxqfAzmC6nAdI2d0McxNmdRuV3ZnixbUSctHdMNLo=
